<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” System Check - Fruit Shop</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .check-item { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .pass { background: #d4edda; color: #155724; }
        .fail { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        h1 { color: #ff6b35; }
        .code { font-family: monospace; background: #f8f9fa; padding: 2px 5px; }
    </style>
</head>
<body>
    <h1>ğŸ” à¸£à¸°à¸šà¸šà¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Fruit Shop</h1>
    <div id="results">à¸à¸³à¸¥à¸±à¸‡à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š...</div>

    <script src="js/utils.js"></script>
    <script src="js/data-manager.js"></script>
    <script>
        async function runSystemCheck() {
            const results = document.getElementById('results');
            results.innerHTML = '';
            
            function addResult(message, status = 'info') {
                const div = document.createElement('div');
                div.className = `check-item ${status}`;
                div.innerHTML = message;
                results.appendChild(div);
            }
            
            addResult('ğŸš€ à¹€à¸£à¸´à¹ˆà¸¡à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸šà¸š...', 'info');
            
            // 1. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Utils
            try {
                const testPrice = Utils.formatPrice(1250);
                if (testPrice === 'à¸¿1,250') {
                    addResult('âœ… Utils.formatPrice() à¸—à¸³à¸‡à¸²à¸™à¹„à¸”à¹‰à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡', 'pass');
                } else {
                    addResult('âŒ Utils.formatPrice() à¸—à¸³à¸‡à¸²à¸™à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡', 'fail');
                }
            } catch (e) {
                addResult('âŒ Utils library à¹‚à¸«à¸¥à¸”à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ: ' + e.message, 'fail');
            }
            
            // 2. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š DataManager
            try {
                const dm = new DataManager();
                addResult('âœ… DataManager class à¸ªà¸£à¹‰à¸²à¸‡à¹„à¸”à¹‰', 'pass');
                
                // à¸—à¸”à¸ªà¸­à¸šà¹‚à¸«à¸¥à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
                const loadResult = await dm.loadData();
                if (dm.products.length > 0) {
                    addResult(`âœ… à¹‚à¸«à¸¥à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸´à¸™à¸„à¹‰à¸²à¹„à¸”à¹‰ ${dm.products.length} à¸£à¸²à¸¢à¸à¸²à¸£`, 'pass');
                } else {
                    addResult('âš ï¸ à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸´à¸™à¸„à¹‰à¸² à¸«à¸£à¸·à¸­à¹‚à¸«à¸¥à¸”à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ', 'fail');
                }
                
                if (dm.categories.length > 0) {
                    addResult(`âœ… à¹‚à¸«à¸¥à¸”à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆà¹„à¸”à¹‰ ${dm.categories.length} à¸«à¸¡à¸§à¸”`, 'pass');
                } else {
                    addResult('âš ï¸ à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ', 'fail');
                }
                
            } catch (e) {
                addResult('âŒ DataManager à¸¡à¸µà¸›à¸±à¸à¸«à¸²: ' + e.message, 'fail');
            }
            
            // 3. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Local Storage
            try {
                Utils.saveToStorage('test', {test: 'value'});
                const loaded = Utils.loadFromStorage('test');
                if (loaded && loaded.test === 'value') {
                    addResult('âœ… Local Storage à¸—à¸³à¸‡à¸²à¸™à¹„à¸”à¹‰', 'pass');
                    Utils.removeFromStorage('test');
                } else {
                    addResult('âŒ Local Storage à¸—à¸³à¸‡à¸²à¸™à¹„à¸¡à¹ˆà¹„à¸”à¹‰', 'fail');
                }
            } catch (e) {
                addResult('âŒ Local Storage à¸¡à¸µà¸›à¸±à¸à¸«à¸²: ' + e.message, 'fail');
            }
            
            // 4. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹„à¸Ÿà¸¥à¹Œ CSS
            const cssLinks = document.querySelectorAll('link[rel="stylesheet"]');
            if (cssLinks.length >= 2) {
                addResult('âœ… à¹„à¸Ÿà¸¥à¹Œ CSS à¸–à¸¹à¸à¹‚à¸«à¸¥à¸”', 'pass');
            } else {
                addResult('âš ï¸ à¹„à¸Ÿà¸¥à¹Œ CSS à¸­à¸²à¸ˆà¸‚à¸²à¸”à¸«à¸²à¸¢', 'fail');
            }
            
            // 5. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Responsive Functions
            try {
                const screenInfo = Utils.getScreenSize();
                addResult(`âœ… Screen Size Detection: ${screenInfo.width}x${screenInfo.height} (${screenInfo.size})`, 'pass');
                
                const isMob = Utils.isMobile();
                addResult(`â„¹ï¸ à¸­à¸¸à¸›à¸à¸£à¸“à¹Œ: ${isMob ? 'Mobile' : 'Desktop/Tablet'}`, 'info');
            } catch (e) {
                addResult('âŒ Responsive functions à¸¡à¸µà¸›à¸±à¸à¸«à¸²: ' + e.message, 'fail');
            }
            
            // 6. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸‚à¸­à¸‡à¸£à¸°à¸šà¸šà¸„à¹‰à¸™à¸«à¸²
            try {
                const dm = dataManager || new DataManager();
                if (dm.products.length > 0) {
                    const searchResult = dm.searchProducts('à¹à¸­à¸›');
                    addResult(`âœ… à¸£à¸°à¸šà¸šà¸„à¹‰à¸™à¸«à¸²à¸—à¸³à¸‡à¸²à¸™à¹„à¸”à¹‰ à¸à¸š ${searchResult.length} à¸£à¸²à¸¢à¸à¸²à¸£`, 'pass');
                }
            } catch (e) {
                addResult('âŒ à¸£à¸°à¸šà¸šà¸„à¹‰à¸™à¸«à¸²à¸¡à¸µà¸›à¸±à¸à¸«à¸²: ' + e.message, 'fail');
            }
            
            // à¸ªà¸£à¸¸à¸›à¸œà¸¥
            addResult('ğŸ“Š à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™', 'info');
            
            const passCount = document.querySelectorAll('.pass').length;
            const failCount = document.querySelectorAll('.fail').length;
            
            if (failCount === 0) {
                addResult(`ğŸ‰ à¸£à¸°à¸šà¸šà¸à¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™! (à¸œà¹ˆà¸²à¸™ ${passCount} à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š)`, 'pass');
            } else {
                addResult(`âš ï¸ à¸à¸šà¸›à¸±à¸à¸«à¸² ${failCount} à¸£à¸²à¸¢à¸à¸²à¸£ à¸ˆà¸²à¸ ${passCount + failCount} à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š`, 'fail');
            }
            
            // à¹€à¸à¸´à¹ˆà¸¡à¸¥à¸´à¸‡à¸à¹Œà¹„à¸›à¸¢à¸±à¸‡à¸«à¸™à¹‰à¸²à¸«à¸¥à¸±à¸
            addResult(`
                <strong>ğŸ”— à¸¥à¸´à¸‡à¸à¹Œà¸—à¸”à¸ªà¸­à¸š:</strong><br>
                <a href="index.html" target="_blank">ğŸ“„ à¸«à¸™à¹‰à¸²à¹à¸£à¸</a> | 
                <a href="products.html" target="_blank">ğŸ›’ à¸£à¸²à¸¢à¸à¸²à¸£à¸ªà¸´à¸™à¸„à¹‰à¸²</a><br>
                <small>à¹€à¸›à¸´à¸”à¹ƒà¸™à¹à¸—à¹‡à¸šà¹ƒà¸«à¸¡à¹ˆà¹€à¸à¸·à¹ˆà¸­à¸—à¸”à¸ªà¸­à¸š</small>
            `, 'info');
        }
        
        // à¹€à¸£à¸´à¹ˆà¸¡à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹€à¸¡à¸·à¹ˆà¸­à¸«à¸™à¹‰à¸²à¹‚à¸«à¸¥à¸”à¹€à¸ªà¸£à¹‡à¸ˆ
        window.addEventListener('load', runSystemCheck);
    </script>
</body>
</html>
